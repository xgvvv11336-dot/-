name: Windows-AnyDesk
on: workflow_dispatch

jobs:
  build:
    runs-on: windows-latest
    steps:
    - name: ติดตั้ง AnyDesk
      shell: powershell
      run: |
        # 1. ดาวน์โหลด AnyDesk
        Invoke-WebRequest -Uri "https://download.anydesk.com/AnyDesk.exe" -OutFile "AnyDesk.exe"
        
        # 2. ตั้งรหัสผ่านสำหรับรีโมท (ในที่นี้คือ 123456)
        echo "123456" | ./AnyDesk.exe --set-password
        
    - name: ดึงเลข ID เครื่องออกมา
      shell: powershell
      run: |
        # 3. สั่งรัน AnyDesk และรอให้มันสร้าง ID
        Start-Process ./AnyDesk.exe
        Start-Sleep -Seconds 15
        
        # 4. ดึงเลข ID มาโชว์ที่หน้า Log
        $anydeskId = ./AnyDesk.exe --get-id
        Write-Host "------------------------------------------"
        Write-Host "เลข ID สำหรับเชื่อมต่อคือ: $anydeskId"
        Write-Host "รหัสผ่านคือ: 123456"
        Write-Host "------------------------------------------"

    - name: เปิดเครื่องทิ้งไว้
      shell: powershell
      run: Start-Sleep -Seconds 21600
